#!/usr/bin/env bash
set -euo pipefail

target_service=${1:-$(s cbi svc select-dwim)}
if [[ $# -gt 0 ]]; then shift; fi

if [ -z $target_service ]; then
  echo "Must provide a service name"
  exit 1
fi

if [ $target_service = cbi-site ]; then
  tmuxinator start cbi-site
  exit 0
fi

if [ -f ~/cbinsights/$target_service/go.mod ]; then
  tmuxinator start cbi-golang-service $target_service
  exit 0
fi

if [ -f ~/cbinsights/$target_service/src/setup.cfg ]; then
  tmuxinator start cbi-python-service $target_service
  exit 0
fi

echo "Unsupported service type?"
exit 1
