#!/usr/bin/env bash
set -euo pipefail

cd ~/.local/share/chezmoi/private_dot_config/exact_nixpkgs

niv update

trap "git checkout -- nix/sources.json; exit 1" ERR
chezmoi apply -i files ~/.config/nixpkgs
s dot run-script home_manager_update
git add nix flake*
git commit -m "niv update" && git push
